<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Book appointment - Medibooks</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@3.2.0/dist/fullcalendar.min.css" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/moment@2.29.1/moment.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@3.2.0/dist/fullcalendar.min.js"></script>
</head>
<body>

  <div class="container mt-5">
    <!-- Doctor Profile Section -->
    <div class="doctor-profile" id="doctorProfileSection">
      <div class="doctor-details" id="doctorDetails">
        <!-- Doctor info will be loaded dynamically -->
      </div>

      <h3>Reviews</h3>
      <!-- Review Section -->
      <div class="review-section">
        <p>Great doctor! Really helped me understand my condition better.</p>
        <p>⭐⭐⭐⭐⭐</p>
        <p>Highly recommend Dr. John for heart-related concerns.</p>
        <p>⭐⭐⭐⭐</p>

        <!-- Review Submission Form -->
        <div class="review-form">
          <textarea placeholder="Write your review..." rows="4" class="form-control"></textarea>
          <button class="btn btn-primary mt-2">Submit Review</button>
        </div>
      </div>

      <h3>Availability</h3>
      <!-- Calendar View for Selecting Appointment Slot -->
      <div class="calendar-view">
        <p>Select a date and time for your appointment:</p>
        <div id="calendar"></div>
      </div>

      <h3>Book Appointment</h3>
      <!-- Patient Information Form -->
      <form id="appointmentForm" class="mb-4" style="display: none;">
        <div class="mb-3">
          <label for="name" class="form-label">Name</label>
          <input type="text" class="form-control" id="name" required>
        </div>
        <div class="mb-3">
          <label for="email" class="form-label">Email</label>
          <input type="email" class="form-control" id="email" required>
        </div>
        <div class="mb-3">
          <label for="phone" class="form-label">Phone</label>
          <input type="tel" class="form-control" id="phone" required>
        </div>
        <div class="mb-3">
          <label for="notes" class="form-label">Notes (Optional)</label>
          <textarea class="form-control" id="notes"></textarea>
        </div>
        <button type="submit" class="btn btn-primary">Confirm Booking</button>
      </form>

      <!-- Confirmation Screen -->
      <div id="confirmationScreen" style="display: none;">
        <h4>Confirm Appointment</h4>
        <p><strong>Name:</strong> <span id="confirmName"></span></p>
        <p><strong>Email:</strong> <span id="confirmEmail"></span></p>
        <p><strong>Phone:</strong> <span id="confirmPhone"></span></p>
        <p><strong>Notes:</strong> <span id="confirmNotes"></span></p>
        <p><strong>Selected Slot:</strong> <span id="confirmSlot"></span></p>
        <button id="confirmButton" class="btn btn-success">Confirm</button>
      </div>
    </div>
  </div>

  <script>
    // Sample Data: Doctors with their specific availability slots
    const doctors = [
      {
        id: 1,
        name: "Dr. John Smith",
        specialization: "Cardiologist",
        experience: "10 years",
        rating: "⭐⭐⭐⭐⭐",
        availableSlots: [
          { date: '2025-02-20T10:00:00', title: 'Available Slot' },
          { date: '2025-02-20T14:00:00', title: 'Available Slot' }
        ]
      },
      {
        id: 2,
        name: "Dr. Emma Davis",
        specialization: "Neurologist",
        experience: "8 years",
        rating: "⭐⭐⭐⭐",
        availableSlots: [
          { date: '2025-02-21T11:00:00', title: 'Available Slot' },
          { date: '2025-02-21T15:00:00', title: 'Available Slot' }
        ]
      },
      {
        id: 3,
        name: "Dr. Michael Brown",
        specialization: "Pediatrician",
        experience: "6 years",
        rating: "⭐⭐⭐⭐",
        availableSlots: [
          { date: '2025-02-22T09:00:00', title: 'Available Slot' },
          { date: '2025-02-22T13:00:00', title: 'Available Slot' }
        ]
      },
      {
        id: 4,
        name: "Dr. Olivia Wilson",
        specialization: "Orthopedic Surgeon",
        experience: "12 years",
        rating: "⭐⭐⭐⭐⭐",
        availableSlots: [
          { date: '2025-02-23T10:00:00', title: 'Available Slot' },
          { date: '2025-02-23T14:00:00', title: 'Available Slot' }
        ]
      },
      {
        id: 5,
        name: "Dr. Liam Johnson",
        specialization: "Dermatologist",
        experience: "5 years",
        rating: "⭐⭐⭐⭐",
        availableSlots: [
          { date: '2025-02-24T10:00:00', title: 'Available Slot' },
          { date: '2025-02-24T15:00:00', title: 'Available Slot' }
        ]
      },
      {
        id: 6,
        name: "Dr. Sophia Martinez",
        specialization: "Gynecologist",
        experience: "9 years",
        rating: "⭐⭐⭐⭐⭐",
        availableSlots: [
          { date: '2025-02-25T10:00:00', title: 'Available Slot' },
          { date: '2025-02-25T14:00:00', title: 'Available Slot' }
        ]
      }
    ];

    // Load the doctor details based on the doctor ID from the URL
    const urlParams = new URLSearchParams(window.location.search);
    const doctorId = urlParams.get('doctorId');
    const doctor = doctors.find(doc => doc.id == doctorId);

    // Display Doctor Information
    if (doctor) {
      document.getElementById('doctorDetails').innerHTML = `
        <img src="/images/doctor${doctor.id}.jpg" alt="${doctor.name}" class="doctor-photo" style="width: 150px; height: 150px;">
        <h2>${doctor.name}</h2>
        <p><strong>Specialization:</strong> ${doctor.specialization}</p>
        <p><strong>Experience:</strong> ${doctor.experience}</p>
        <p><strong>Rating:</strong> ${doctor.rating}</p>
      `;
    }

    // Initialize the calendar with doctor's available slots
    $(document).ready(function() {
      $('#calendar').fullCalendar({
        header: {
          left: 'prev,next today',
          center: 'title',
          right: 'month,agendaWeek,agendaDay'
        },
        events: doctor ? doctor.availableSlots : [], // Only show slots for the current doctor
        selectable: true,
        select: function(start, end) {
          const selectedDate = start.format('YYYY-MM-DD');
          const selectedTime = start.format('HH:mm');
          const selectedSlot = `${selectedDate} at ${selectedTime}`;

          // Show the booking form
          $('#appointmentForm').show();
          $('#confirmationScreen').hide();

          $('#confirmSlot').text(selectedSlot);
        }
      });
    });

    // Handle form submission and show confirmation
    $('#appointmentForm').on('submit', function(e) {
      e.preventDefault();

      const name = $('#name').val();
      const email = $('#email').val();
      const phone = $('#phone').val();
      const notes = $('#notes').val();
      const selectedSlot = $('#confirmSlot').text();

      // Show confirmation screen
      $('#confirmName').text(name);
      $('#confirmEmail').text(email);
      $('#confirmPhone').text(phone);
      $('#confirmNotes').text(notes);
      $('#confirmSlot').text(selectedSlot);

      $('#appointmentForm').hide();
      $('#confirmationScreen').show();
    });

    // Handle final confirmation
    $('#confirmButton').on('click', function() {
      alert('Your appointment has been confirmed!');
      // You can send the data to the server here (e.g., using AJAX).
    });
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
